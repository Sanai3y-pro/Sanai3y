@model sanaiy.UI.ViewModels.SettingViewModel
@{
    ViewData["Title"] = "Account Settings";
    var userType = Model.UserType ?? "client";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Sanaiy</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

    <style>
        .material-icons {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        body {
            background-color: #F7F9FC;
            font-family: 'Roboto', sans-serif;
        }

        .dark body {
            background-color: #121212;
        }

        .setting-section {
            transition: all 0.3s ease;
        }

            .setting-section:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            }

        .danger-zone {
            border-left: 4px solid #D32F2F;
        }

        .success-message {
            animation: fadeInOut 3s ease-in-out;
        }

        @@keyframes fadeInOut {
            0%, 100% {
                opacity: 0;
            }

            10%, 90% {
                opacity: 1;
            }
        }
    </style>

    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#0D47A1",
                        "background-light": "#F7F9FC",
                        "background-dark": "#121212",
                        danger: "#D32F2F",
                        success: "#4CAF50",
                        warning: "#FF9800"
                    },
                    fontFamily: {
                        display: ["Roboto", "sans-serif"]
                    },
                },
            },
        };

        document.addEventListener("DOMContentLoaded", function() {
            // Handle dark mode toggle
            const themeToggle = document.getElementById('theme-toggle');
            if (themeToggle) {
                themeToggle.addEventListener('click', function() {
                    if (document.documentElement.classList.contains('dark')) {
                        document.documentElement.classList.remove('dark');
                        localStorage.setItem('theme', 'light');
                    } else {
                        document.documentElement.classList.add('dark');
                        localStorage.setItem('theme', 'dark');
                    }
                });
            }

            // Check for saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.documentElement.classList.add('dark');
            }

            // Handle password visibility toggle
            const togglePasswordBtns = document.querySelectorAll('.toggle-password');
            togglePasswordBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const input = this.closest('.input-group').querySelector('input');
                    const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
                    input.setAttribute('type', type);
                    this.textContent = type === 'password' ? 'visibility' : 'visibility_off';
                });
            });

            // Delete account modal
            const deleteModal = document.getElementById('deleteModal');
            const openDeleteBtn = document.getElementById('openDeleteModal');
            const closeDeleteBtn = document.getElementById('closeDeleteModal');

            if (openDeleteBtn) {
                openDeleteBtn.addEventListener('click', function() {
                    deleteModal.classList.remove('hidden');
                });
            }

            if (closeDeleteBtn) {
                closeDeleteBtn.addEventListener('click', function() {
                    deleteModal.classList.add('hidden');
                });
            }

            // Close modal when clicking outside
            if (deleteModal) {
                deleteModal.addEventListener('click', function(e) {
                    if (e.target === deleteModal) {
                        deleteModal.classList.add('hidden');
                    }
                });
            }

            // Close modal with Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && !deleteModal.classList.contains('hidden')) {
                    deleteModal.classList.add('hidden');
                }
            });

            // Handle form validation
            const changePasswordForm = document.getElementById('changePasswordForm');
            if (changePasswordForm) {
                changePasswordForm.addEventListener('submit', function(e) {
                    const newPassword = document.getElementById('NewPassword').value;
                    const confirmPassword = document.getElementById('ConfirmNewPassword').value;

                    if (newPassword !== confirmPassword) {
                        e.preventDefault();
                        alert('New password and confirmation do not match.');
                    }
                });
            }

            // Auto-hide success/error messages
            setTimeout(function() {
                const messages = document.querySelectorAll('.alert-message');
                messages.forEach(msg => {
                    msg.style.opacity = '0';
                    setTimeout(() => msg.remove(), 300);
                });
            }, 5000);
        });
    </script>
</head>

<body class="bg-background-light dark:bg-background-dark font-display min-h-screen pt-20">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Page Header -->
        <div class="mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-gray-800 dark:text-white">Account Settings</h1>
                    <p class="text-gray-600 dark:text-gray-300 mt-2">Manage your account preferences and security</p>
                </div>
                <a href="/Craftsman/Home"
                   class="flex items-center px-4 py-2 bg-orange-400 hover:bg-orange-500 text-white rounded-md transition-colors">
                    <i class="material-icons mr-2">arrow_back</i>
                    Back to Dashboard
                </a>
            </div>
        </div>

        <!-- Success/Error Messages -->
        @if (TempData["Success"] != null)
        {
            <div class="alert-message mb-6 p-4 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-lg border border-green-300 dark:border-green-700">
                <div class="flex items-center">
                    <i class="material-icons mr-2">check_circle</i>
                    <span>@TempData["Success"]</span>
                </div>
            </div>
        }

        @if (TempData["Error"] != null)
        {
            <div class="alert-message mb-6 p-4 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 rounded-lg border border-red-300 dark:border-red-700">
                <div class="flex items-center">
                    <i class="material-icons mr-2">error</i>
                    <span>@TempData["Error"]</span>
                </div>
            </div>
        }

        <!-- Account Overview -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8 setting-section">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-semibold text-gray-800 dark:text-white">Account Overview</h2>
                <button id="theme-toggle" class="p-2 rounded-full bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600">
                    <i class="material-icons text-gray-600 dark:text-gray-300">dark_mode</i>
                </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="flex items-center space-x-4">
                    <div class="w-16 h-16 rounded-full bg-primary flex items-center justify-center">
                        @if (!string.IsNullOrEmpty(ViewBag.ProfileImageUrl))
                        {
                            <img src="@ViewBag.ProfileImageUrl" alt="Profile" class="w-full h-full rounded-full object-cover" />
                        }
                        else
                        {
                            <span class="material-icons text-white text-3xl">person</span>
                        }
                    </div>
                    <div>
                        <h3 class="text-lg font-medium text-gray-800 dark:text-white">@User.Identity?.Name</h3>
                        <p class="text-gray-600 dark:text-gray-300">Craftsman Account</p>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Member since @DateTime.Now.ToString("MMMM yyyy")</p>
                    </div>
                </div>

                <div class="space-y-3">
                    <div class="flex items-center justify-between">
                        <span class="text-gray-600 dark:text-gray-300">Account Status</span>
                        <span class="px-3 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-full text-sm font-medium">
                            Active
                        </span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-gray-600 dark:text-gray-300">Email Verified</span>
                        <span class="material-icons text-green-500">verified</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-gray-600 dark:text-gray-300">Profile Complete</span>
                        <span class="text-gray-600 dark:text-gray-300">85%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Change Password Section -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8 setting-section">
            <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-6">Change Password</h2>

            <form id="changePasswordForm" asp-action="ChangePassword" method="POST" class="space-y-6">
                <div class="space-y-4">
                    <div class="input-group">
                        <label for="CurrentPassword" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                            Current Password
                        </label>
                        <div class="relative">
                            <input asp-for="CurrentPassword" type="password"
                                   class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"
                                   placeholder="Enter current password"
                                   required />
                            <button type="button" class="toggle-password absolute right-3 top-3 text-gray-500 dark:text-gray-400">
                                <i class="material-icons">visibility</i>
                            </button>
                        </div>
                        <span asp-validation-for="CurrentPassword" class="text-red-500 text-sm mt-1"></span>
                    </div>

                    <div class="input-group">
                        <label for="NewPassword" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                            New Password
                        </label>
                        <div class="relative">
                            <input asp-for="NewPassword" type="password"
                                   class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"
                                   placeholder="Enter new password"
                                   minlength="6"
                                   required />
                            <button type="button" class="toggle-password absolute right-3 top-3 text-gray-500 dark:text-gray-400">
                                <i class="material-icons">visibility</i>
                            </button>
                        </div>
                        <span asp-validation-for="NewPassword" class="text-red-500 text-sm mt-1"></span>
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Minimum 6 characters</p>
                    </div>

                    <div class="input-group">
                        <label for="ConfirmNewPassword" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                            Confirm New Password
                        </label>
                        <div class="relative">
                            <input asp-for="ConfirmNewPassword" type="password"
                                   class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"
                                   placeholder="Confirm new password"
                                   required />
                            <button type="button" class="toggle-password absolute right-3 top-3 text-gray-500 dark:text-gray-400">
                                <i class="material-icons">visibility</i>
                            </button>
                        </div>
                        <span asp-validation-for="ConfirmNewPassword" class="text-red-500 text-sm mt-1"></span>
                    </div>
                </div>

                <div class="flex items-center pt-4">
                    <button type="submit"
                            class="px-6 py-3 bg-primary hover:bg-blue-800 text-white font-medium rounded-lg transition-colors flex items-center">
                        <i class="material-icons mr-2">lock</i>
                        Update Password
                    </button>
                </div>
            </form>
        </div>

        <!-- Account Preferences -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8 setting-section">
            <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-6">Preferences</h2>

            <div class="space-y-4">
                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <div>
                        <h3 class="font-medium text-gray-800 dark:text-white">Email Notifications</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-300">Receive emails about bookings and updates</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" class="sr-only peer" checked>
                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary"></div>
                    </label>
                </div>

                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <div>
                        <h3 class="font-medium text-gray-800 dark:text-white">SMS Notifications</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-300">Receive SMS alerts for urgent bookings</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" class="sr-only peer" checked>
                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary"></div>
                    </label>
                </div>

                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <div>
                        <h3 class="font-medium text-gray-800 dark:text-white">Auto-accept Bookings</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-300">Automatically accept bookings during available hours</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" class="sr-only peer">
                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary"></div>
                    </label>
                </div>
            </div>

            <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
                <button class="px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    Save Preferences
                </button>
            </div>
        </div>

        <!-- Danger Zone -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 danger-zone">
            <div class="flex items-center mb-6">
                <i class="material-icons text-danger mr-3">warning</i>
                <h2 class="text-xl font-semibold text-gray-800 dark:text-white">Danger Zone</h2>
            </div>

            <p class="text-gray-600 dark:text-gray-300 mb-6">
                Deleting your account is a permanent action. All your data, including bookings, reviews, and earnings history will be permanently removed. This action cannot be undone.
            </p>

            <button id="openDeleteModal"
                    class="px-6 py-3 bg-danger hover:bg-red-700 text-white font-medium rounded-lg transition-colors flex items-center">
                <i class="material-icons mr-2">delete</i>
                Delete My Account
            </button>

            <!-- Delete Confirmation Modal -->
            <div id="deleteModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50 p-4">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 w-full max-w-md">
                    <div class="flex items-center mb-4">
                        <i class="material-icons text-danger mr-3">warning</i>
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white">Confirm Account Deletion</h3>
                    </div>

                    <p class="text-gray-600 dark:text-gray-300 mb-6">
                        This action cannot be undone. Deleting your account will permanently remove all your data, including:
                    </p>

                    <ul class="space-y-2 mb-6">
                        <li class="flex items-center text-gray-600 dark:text-gray-300">
                            <i class="material-icons text-sm mr-2">cancel</i>
                            All your service listings
                        </li>
                        <li class="flex items-center text-gray-600 dark:text-gray-300">
                            <i class="material-icons text-sm mr-2">cancel</i>
                            Booking history
                        </li>
                        <li class="flex items-center text-gray-600 dark:text-gray-300">
                            <i class="material-icons text-sm mr-2">cancel</i>
                            Reviews and ratings
                        </li>
                        <li class="flex items-center text-gray-600 dark:text-gray-300">
                            <i class="material-icons text-sm mr-2">cancel</i>
                            Wallet balance and earnings
                        </li>
                    </ul>

                    <form asp-action="DeleteAccount" method="POST" class="space-y-4">
                        <div>
                            <label for="DeletePassword" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                                Enter your password to confirm
                            </label>
                            <input asp-for="DeletePassword" type="password" required
                                   class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-danger focus:border-transparent"
                                   placeholder="Enter your current password" />
                            <span asp-validation-for="DeletePassword" class="text-red-500 text-sm mt-1"></span>
                        </div>

                        <div class="flex justify-end gap-3 pt-4">
                            <button type="button" id="closeDeleteModal"
                                    class="px-5 py-2.5 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                                Cancel
                            </button>
                            <button type="submit"
                                    class="px-5 py-2.5 bg-danger hover:bg-red-700 text-white rounded-lg transition-colors flex items-center">
                                <i class="material-icons mr-2">delete_forever</i>
                                Delete Account
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Links -->
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-900 rounded-xl p-6">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Quick Links</h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                <a href="/Craftsman/Profile"
                   class="flex items-center p-3 bg-white dark:bg-gray-800 rounded-lg hover:shadow-md transition-shadow">
                    <i class="material-icons text-primary mr-3">person</i>
                    <span class="text-gray-700 dark:text-gray-300">Edit Profile</span>
                </a>
                <a href="/Craftsman/Wallet"
                   class="flex items-center p-3 bg-white dark:bg-gray-800 rounded-lg hover:shadow-md transition-shadow">
                    <i class="material-icons text-green-500 mr-3">wallet</i>
                    <span class="text-gray-700 dark:text-gray-300">Wallet</span>
                </a>
                <a href="/Craftsman/Bookings"
                   class="flex items-center p-3 bg-white dark:bg-gray-800 rounded-lg hover:shadow-md transition-shadow">
                    <i class="material-icons text-orange-500 mr-3">calendar_today</i>
                    <span class="text-gray-700 dark:text-gray-300">Bookings</span>
                </a>
                <a href="/Craftsman/Home"
                   class="flex items-center p-3 bg-white dark:bg-gray-800 rounded-lg hover:shadow-md transition-shadow">
                    <i class="material-icons text-purple-500 mr-3">dashboard</i>
                    <span class="text-gray-700 dark:text-gray-300">Dashboard</span>
                </a>
            </div>
        </div>
    </div>
</body>
</html>
[file content end]